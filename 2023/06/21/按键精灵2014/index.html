<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon-package/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-package/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-package/favicon-16x16.png">
  <link rel="mask-icon" href="/assets/images/favicon-package/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/assets/images/favicon-package/site.webmanifest">
  <meta name="google-site-verification" content="qIz-Tg08U6gyN_53z89yii0ZmKx2avfsO-iyOWhsRx8">
  <meta name="msvalidate.01" content="096F3D01D2AA04148F10750CD4566535">
  <meta name="yandex-verification" content="43f790b7e38394a4">
  <meta name="baidu-site-verification" content="codeva-LMZoUaXjJl">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"loli.fj.cn","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-light","dark":"atom-one-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"language":true},"bookmark":{"enable":true,"color":"#222","save":"manual"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="前言按键精灵2014学习笔记按键精灵2014的脚本是基于VB开发的，可以使用部分VB内置命令；按键精灵X的脚本是基于Lua开发的源码的后缀名为.Q，但是文件中不仅包含了源码，还包含了文件属性，可以通过按键精灵2014的编辑器来修改和调试源码">
<meta property="og:type" content="article">
<meta property="og:title" content="【笔记】按键精灵2014">
<meta property="og:url" content="https://loli.fj.cn/2023/06/21/%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B52014/index.html">
<meta property="og:site_name" content="57uv6Z6g55qE5Y2a5a6i">
<meta property="og:description" content="前言按键精灵2014学习笔记按键精灵2014的脚本是基于VB开发的，可以使用部分VB内置命令；按键精灵X的脚本是基于Lua开发的源码的后缀名为.Q，但是文件中不仅包含了源码，还包含了文件属性，可以通过按键精灵2014的编辑器来修改和调试源码">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-06-21T08:31:25.000Z">
<meta property="article:modified_time" content="2025-10-25T07:39:44.959Z">
<meta property="article:author" content="57uv6Z6g">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://loli.fj.cn/2023/06/21/%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B52014/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://loli.fj.cn/2023/06/21/%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B52014/","path":"2023/06/21/按键精灵2014/","title":"【笔记】按键精灵2014"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【笔记】按键精灵2014 | 57uv6Z6g55qE5Y2a5a6i</title>
  






  <script async defer data-website-id="981ed5a0-eea5-4426-a8a9-c16a789ccc3f" src="https://umami.loli.fj.cn/script.js" data-host-url="https://umami.loli.fj.cn/"></script>


  
  <script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
  <script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous" defer></script>
  <script src="/lib/pangu/dist/browser/pangu.umd.js" integrity="sha256-erngBMP3zzoIM6eqQ8dmrReh2vqCRgWmORroIfVoDlE=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="/lib/hexo-generator-searchdb/dist/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"/lib/mathjax/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="57uv6Z6g55qE5Y2a5a6i" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">57uv6Z6g55qE5Y2a5a6i</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">MS4wLjABAAAA5qMD8Gzdcgq7HXUOviKB59i0-ybJ59jJvNzyaPt5XOsVNqP6DU7WLcoAXvdxvYdp💗<br><font color="red">本站所有文章仅作技术研究，请勿非法破坏，请遵守相关法律法规，后果自负</font></p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-reward"><a href="/reward/" rel="section"><i class="fa fa-hand-holding-heart fa-fw"></i>赞助</a></li><li class="menu-item menu-item-command"><a href="/command/" rel="section"><i class="fa fa-book fa-fw"></i>指令</a></li><li class="menu-item menu-item-contribute"><a href="/contribute/" rel="section"><i class="fa fa-chart-line fa-fw"></i>贡献</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>订阅</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

<link rel="manifest" href="/assets/images/favicon-package/site.webmanifest">

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B3%A8%E9%87%8A"><span class="nav-number">2.</span> <span class="nav-text">注释</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BB%B6%E6%97%B6"><span class="nav-number">3.</span> <span class="nav-text">延时</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E5%8F%98%E9%87%8F"><span class="nav-number">4.</span> <span class="nav-text">声明变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A3%B0%E6%98%8E%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="nav-number">5.</span> <span class="nav-text">声明全局变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%8F%98%E9%87%8F"><span class="nav-number">6.</span> <span class="nav-text">定义变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E7%94%A8%E6%88%B7%E5%8F%98%E9%87%8F"><span class="nav-number">7.</span> <span class="nav-text">定义用户变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E5%88%B0%E6%8E%A7%E5%88%B6%E5%8F%B0"><span class="nav-number">8.</span> <span class="nav-text">输出到控制台</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-number">9.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">9.1.</span> <span class="nav-text">字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5"><span class="nav-number">9.1.1.</span> <span class="nav-text">字符串拼接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%86%E5%89%B2"><span class="nav-number">9.1.2.</span> <span class="nav-text">字符串分割</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">9.1.2.1.</span> <span class="nav-text">查找子字符串</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%BF%E6%8D%A2%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">9.1.2.2.</span> <span class="nav-text">替换子字符串</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%80%92%E7%BD%AE%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%E9%A1%BA%E5%BA%8F"><span class="nav-number">9.1.2.3.</span> <span class="nav-text">倒置字符串中的字符顺序</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%88%AA%E5%8F%96%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">9.1.2.4.</span> <span class="nav-text">截取字符串</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="nav-number">9.2.</span> <span class="nav-text">转义字符</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%A2%E8%A1%8C%E7%AC%A6"><span class="nav-number">9.2.1.</span> <span class="nav-text">换行符</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E7%BB%84"><span class="nav-number">9.3.</span> <span class="nav-text">数组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84"><span class="nav-number">9.3.1.</span> <span class="nav-text">定义数组</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6"><span class="nav-number">9.3.2.</span> <span class="nav-text">获取数组长度</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">10.</span> <span class="nav-text">运算符</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">10.1.</span> <span class="nav-text">比较运算符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="nav-number">10.2.</span> <span class="nav-text">逻辑运算符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5"><span class="nav-number">11.</span> <span class="nav-text">循环语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Where%E5%BE%AA%E7%8E%AF"><span class="nav-number">11.1.</span> <span class="nav-text">Where循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#For%E5%BE%AA%E7%8E%AF"><span class="nav-number">11.2.</span> <span class="nav-text">For循环</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="nav-number">12.</span> <span class="nav-text">条件语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%88%A4%E6%96%AD"><span class="nav-number">12.1.</span> <span class="nav-text">数值判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%9C%E8%89%B2%E5%88%A4%E6%96%AD"><span class="nav-number">12.2.</span> <span class="nav-text">颜色判断</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E9%BC%A0%E6%A0%87%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E7%9A%84%E9%A2%9C%E8%89%B2%E5%80%BC"><span class="nav-number">12.2.1.</span> <span class="nav-text">获取鼠标当前位置的颜色值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E6%89%BE%E8%89%B2"><span class="nav-number">12.2.2.</span> <span class="nav-text">定位找色</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%BA%E5%9F%9F%E6%89%BE%E8%89%B2"><span class="nav-number">12.2.3.</span> <span class="nav-text">区域找色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E9%85%8D%E7%BD%AE"><span class="nav-number">12.2.3.1.</span> <span class="nav-text">更多配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E5%88%A4%E6%96%AD"><span class="nav-number">12.3.</span> <span class="nav-text">图片判断</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E6%A0%87%E5%87%86%E8%89%B2%E5%9D%97%E6%95%B0%E9%87%8F"><span class="nav-number">12.3.1.</span> <span class="nav-text">查找标准色块数量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E6%9F%A5%E6%89%BE%E6%A0%87%E5%87%86%E8%89%B2%E5%9D%97%E6%95%B0%E9%87%8F"><span class="nav-number">12.3.1.1.</span> <span class="nav-text">后台查找标准色块数量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E6%9F%A5%E6%89%BE%E6%A0%87%E5%87%86%E8%89%B2%E5%9D%97%E4%BD%8D%E7%BD%AE"><span class="nav-number">12.3.1.2.</span> <span class="nav-text">后台查找标准色块位置</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E9%BC%A0%E6%A0%87"><span class="nav-number">13.</span> <span class="nav-text">操作鼠标</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E9%BC%A0%E6%A0%87%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE%E7%9A%84%E5%9D%90%E6%A0%87"><span class="nav-number">13.1.</span> <span class="nav-text">获取鼠标当前位置的坐标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%BB%E5%8A%A8%E9%BC%A0%E6%A0%87"><span class="nav-number">13.2.</span> <span class="nav-text">移动鼠标</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E5%AE%9A%E4%BD%8D%E7%A7%BB%E5%8A%A8"><span class="nav-number">13.2.1.</span> <span class="nav-text">绝对定位移动</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B8%E5%AF%B9%E5%AE%9A%E4%BD%8D%E7%A7%BB%E5%8A%A8"><span class="nav-number">13.2.2.</span> <span class="nav-text">相对定位移动</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A6%E9%94%AE%E5%8D%95%E6%9C%BA"><span class="nav-number">13.3.</span> <span class="nav-text">左键单机</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E9%94%AE%E7%9B%98"><span class="nav-number">14.</span> <span class="nav-text">操作键盘</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A8%8B%E5%BA%8F%E6%9A%82%E5%81%9C%E7%AD%89%E5%BE%85%E6%8C%89%E9%94%AE"><span class="nav-number">14.1.</span> <span class="nav-text">程序暂停等待按键</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%8C%89%E4%B8%8B%E7%9A%84%E9%94%AE%E7%A0%81%E5%80%BC"><span class="nav-number">14.1.1.</span> <span class="nav-text">获取按下的键码值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E6%B5%8B%E4%B8%8A%E6%AC%A1%E6%8C%89%E8%BF%87%E7%9A%84%E9%94%AE"><span class="nav-number">14.2.</span> <span class="nav-text">检测上次按过的键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%93%E5%87%BA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">14.3.</span> <span class="nav-text">输出字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E8%BE%93%E5%87%BA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">14.3.1.</span> <span class="nav-text">后台输出字符串</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E4%B8%8B%E6%8C%87%E5%AE%9A%E6%8C%89%E9%94%AE"><span class="nav-number">14.4.</span> <span class="nav-text">按下指定按键</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%8E%E5%8F%B0%E6%8C%89%E4%B8%8B%E6%8C%87%E5%AE%9A%E6%8C%89%E9%94%AE"><span class="nav-number">14.4.1.</span> <span class="nav-text">后台按下指定按键</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E8%BD%AC%E9%94%AE%E7%A0%81%E5%80%BC"><span class="nav-number">14.4.2.</span> <span class="nav-text">字符转键码值</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%B9%E5%87%BA%E6%B6%88%E6%81%AF%E7%AA%97"><span class="nav-number">15.</span> <span class="nav-text">弹出消息窗</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B1%8F%E5%B9%95%E8%BE%93%E5%87%BA%E6%96%87%E6%9C%AC%E6%A1%86"><span class="nav-number">16.</span> <span class="nav-text">屏幕输出文本框</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E9%99%A4%E6%96%87%E6%9C%AC%E6%A1%86"><span class="nav-number">16.1.</span> <span class="nav-text">清除文本框</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E6%A0%8F%E5%9B%BE%E6%A0%87%E6%B0%94%E6%B3%A1"><span class="nav-number">17.</span> <span class="nav-text">状态栏图标气泡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">18.</span> <span class="nav-text">子程序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">18.1.</span> <span class="nav-text">定义子程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E5%8F%82"><span class="nav-number">18.1.1.</span> <span class="nav-text">无参</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%8F%82"><span class="nav-number">18.1.2.</span> <span class="nav-text">有参</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E5%AD%90%E7%A8%8B%E5%BA%8F"><span class="nav-number">18.2.</span> <span class="nav-text">调用子程序</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E5%8F%82-1"><span class="nav-number">18.2.1.</span> <span class="nav-text">无参</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%89%E5%8F%82-1"><span class="nav-number">18.2.2.</span> <span class="nav-text">有参</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.</span> <span class="nav-text">窗口句柄</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.1.</span> <span class="nav-text">获取窗口句柄</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E9%BC%A0%E6%A0%87%E7%9A%84%E4%BD%8D%E7%BD%AE%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.1.1.</span> <span class="nav-text">通过鼠标的位置获取窗口句柄</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E7%B1%BB%E5%90%8D%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.1.2.</span> <span class="nav-text">通过类名获取窗口句柄</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%A0%B9%E7%BA%A7%E7%9A%84%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.1.2.1.</span> <span class="nav-text">获取根级的窗口句柄</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%AD%90%E7%BA%A7%E7%9A%84%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84"><span class="nav-number">19.1.2.2.</span> <span class="nav-text">获取子级的窗口句柄</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84%E8%8E%B7%E5%8F%96%E7%AA%97%E5%8F%A3%E4%BD%8D%E7%BD%AE"><span class="nav-number">19.2.</span> <span class="nav-text">通过窗口句柄获取窗口位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E7%AA%97%E5%8F%A3%E5%8F%A5%E6%9F%84%E6%93%8D%E4%BD%9C%E9%BC%A0%E6%A0%87"><span class="nav-number">19.3.</span> <span class="nav-text">通过窗口句柄操作鼠标</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E6%9C%BA%E5%B7%A6%E9%94%AE"><span class="nav-number">19.3.1.</span> <span class="nav-text">单机左键</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="nav-number">20.</span> <span class="nav-text">生成随机数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E6%8C%87%E5%AE%9A%E8%8C%83%E5%9B%B4%E7%9A%84%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="nav-number">20.1.</span> <span class="nav-text">生成指定范围的随机数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%BD%AE%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%A7%8D%E5%AD%90"><span class="nav-number">20.2.</span> <span class="nav-text">重置随机数种子</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E4%BB%B6"><span class="nav-number">21.</span> <span class="nav-text">事件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%84%9A%E6%9C%AC%E5%81%9C%E6%AD%A2%E8%BF%90%E8%A1%8C%E4%BA%8B%E4%BB%B6"><span class="nav-number">21.1.</span> <span class="nav-text">脚本停止运行事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E5%87%BB%E4%BA%8B%E4%BB%B6"><span class="nav-number">21.2.</span> <span class="nav-text">点击事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AA%97%E4%BD%93%E5%8A%A0%E8%BD%BD%E4%BA%8B%E4%BB%B6"><span class="nav-number">21.3.</span> <span class="nav-text">窗体加载事件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#QUI%E7%BB%84%E4%BB%B6"><span class="nav-number">22.</span> <span class="nav-text">QUI组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E6%A1%86"><span class="nav-number">22.1.</span> <span class="nav-text">文本框</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E6%9C%AC%E6%A1%86%E5%86%85%E5%AE%B9"><span class="nav-number">22.1.1.</span> <span class="nav-text">获取文本框内容</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%BD%AC%E6%8D%A2%E4%B8%BA%E6%95%B4%E5%9E%8B"><span class="nav-number">22.1.1.1.</span> <span class="nav-text">转换为整型</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E6%96%87%E6%9C%AC%E6%A1%86%E5%86%85%E5%AE%B9"><span class="nav-number">22.1.2.</span> <span class="nav-text">修改文本框内容</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8"><span class="nav-number">22.2.</span> <span class="nav-text">下拉列表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%89%80%E6%9C%89%E9%80%89%E9%A1%B9"><span class="nav-number">22.2.1.</span> <span class="nav-text">定义所有选项</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%89%8D%E7%AB%AF%E6%98%BE%E7%A4%BA"><span class="nav-number">22.2.1.1.</span> <span class="nav-text">前端显示</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%8E%E6%AE%B5%E5%AE%9E%E9%99%85%E6%95%B0%E6%8D%AE"><span class="nav-number">22.2.1.2.</span> <span class="nav-text">后段实际数据</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E9%BB%98%E8%AE%A4%E9%80%89%E9%A1%B9"><span class="nav-number">22.2.2.</span> <span class="nav-text">定义默认选项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E9%80%89%E6%8B%A9"><span class="nav-number">22.3.</span> <span class="nav-text">文件选择</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E7%A8%8B%E5%BA%8F"><span class="nav-number">23.</span> <span class="nav-text">运行程序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="nav-number">24.</span> <span class="nav-text">多线程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8%E7%BA%BF%E7%A8%8B"><span class="nav-number">24.1.</span> <span class="nav-text">启动线程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%BA%BF%E7%A8%8BID"><span class="nav-number">24.1.1.</span> <span class="nav-text">获取线程ID</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%9C%E6%AD%A2%E6%8C%87%E5%AE%9A%E7%BA%BF%E7%A8%8B"><span class="nav-number">24.2.</span> <span class="nav-text">停止指定线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%A7%E7%BB%AD%E7%BA%BF%E7%A8%8B"><span class="nav-number">24.3.</span> <span class="nav-text">继续线程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">25.</span> <span class="nav-text">配置文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%B2%BE%E7%81%B5%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">25.1.</span> <span class="nav-text">小精灵配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">25.2.</span> <span class="nav-text">写入自定义配置文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-number">25.3.</span> <span class="nav-text">读取自定义配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%97%B6%E9%97%B4"><span class="nav-number">26.</span> <span class="nav-text">获取当前时间</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E5%BD%93%E5%89%8D%E7%B3%BB%E7%BB%9F%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4"><span class="nav-number">26.1.</span> <span class="nav-text">从当前系统获取时间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E7%BD%91%E7%BB%9C%E8%8E%B7%E5%8F%96%E6%97%B6%E9%97%B4"><span class="nav-number">26.2.</span> <span class="nav-text">从网络获取时间</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%BD%9C%E4%B8%BA%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="nav-number">27.</span> <span class="nav-text">字符串作为命令执行</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%BB%E5%86%99%E6%96%87%E4%BB%B6"><span class="nav-number">28.</span> <span class="nav-text">读写文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6"><span class="nav-number">28.1.</span> <span class="nav-text">打开文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6"><span class="nav-number">28.2.</span> <span class="nav-text">关闭文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-number">28.3.</span> <span class="nav-text">读取文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E8%A1%8C%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6"><span class="nav-number">28.3.1.</span> <span class="nav-text">按行读取文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99%E4%BD%8D%E7%BD%AE"><span class="nav-number">28.4.</span> <span class="nav-text">设置文件读写位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E9%95%BF%E5%BA%A6"><span class="nav-number">28.5.</span> <span class="nav-text">获取文件内容长度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="nav-number">28.6.</span> <span class="nav-text">写入文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%9C%AB%E5%B0%BE%E8%BF%BD%E5%8A%A0%E4%B8%80%E8%A1%8C%E6%96%87%E6%9C%AC"><span class="nav-number">28.6.1.</span> <span class="nav-text">文件末尾追加一行文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E5%BD%93%E5%89%8D%E5%85%89%E6%A0%87%E5%A4%84%E5%86%99%E5%85%A5%E6%96%87%E6%9C%AC"><span class="nav-number">28.6.2.</span> <span class="nav-text">在当前光标处写入文本</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%96%87%E4%BB%B6%E6%9C%AB%E5%B0%BE%E8%BF%BD%E5%8A%A0%E5%86%99%E5%85%A5"><span class="nav-number">28.6.2.1.</span> <span class="nav-text">在文件末尾追加写入</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%A8%E5%BD%93%E5%89%8D%E5%85%89%E6%A0%87%E5%A4%84%E5%86%99%E5%85%A5%E4%B8%80%E8%A1%8C%E6%96%87%E6%9C%AC"><span class="nav-number">28.6.3.</span> <span class="nav-text">在当前光标处写入一行文本</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%96%87%E4%BB%B6%E6%9C%AB%E5%B0%BE%E8%BF%BD%E5%8A%A0%E5%86%99%E5%85%A5-1"><span class="nav-number">28.6.3.1.</span> <span class="nav-text">在文件末尾追加写入</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%BB%E5%86%99Excel%E6%96%87%E4%BB%B6"><span class="nav-number">29.</span> <span class="nav-text">读写Excel文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%BC%80Excel%E6%96%87%E4%BB%B6"><span class="nav-number">29.1.</span> <span class="nav-text">打开Excel文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6-1"><span class="nav-number">29.2.</span> <span class="nav-text">关闭文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6-1"><span class="nav-number">29.3.</span> <span class="nav-text">写入文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%91%E9%80%81HTTP%E8%AF%B7%E6%B1%82"><span class="nav-number">30.</span> <span class="nav-text">发送HTTP请求</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Get"><span class="nav-number">30.1.</span> <span class="nav-text">Get</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Post"><span class="nav-number">30.2.</span> <span class="nav-text">Post</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E6%88%AA%E5%9B%BE"><span class="nav-number">31.</span> <span class="nav-text">保存截图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E5%89%AA%E8%B4%B4%E6%9D%BF"><span class="nav-number">32.</span> <span class="nav-text">操作剪贴板</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%89%AA%E8%B4%B4%E6%9D%BF%E5%86%85%E5%AE%B9"><span class="nav-number">32.1.</span> <span class="nav-text">获取剪贴板内容</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">33.</span> <span class="nav-text">函数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E5%BA%93"><span class="nav-number">34.</span> <span class="nav-text">命令库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E6%88%90"><span class="nav-number">35.</span> <span class="nav-text">完成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-number">36.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="57uv6Z6g"
      src="/assets/images/avatar.gif">
  <p class="site-author-name" itemprop="name">57uv6Z6g</p>
  <div class="site-description" itemprop="description">5o2V5o2J5LiA5Y+q54ix5oqY6IW+55qE57uv6Z6g</div>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:00-isomer-cabbies@icloud.com" title="E-Mail → mailto:00-isomer-cabbies@icloud.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/LittleSweetCookie" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;LittleSweetCookie" rel="noopener me" target="_blank"><i class="fab fa-telegram fa-fw"></i>Telegram</a>
      </span>
  </div>

<div id="aplayer-app"></div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://loli.fj.cn/2023/06/21/%E6%8C%89%E9%94%AE%E7%B2%BE%E7%81%B52014/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.gif">
      <meta itemprop="name" content="57uv6Z6g">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="57uv6Z6g55qE5Y2a5a6i">
      <meta itemprop="description" content="5o2V5o2J5LiA5Y+q54ix5oqY6IW+55qE57uv6Z6g">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【笔记】按键精灵2014 | 57uv6Z6g55qE5Y2a5a6i">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【笔记】按键精灵2014
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-21 16:31:25" itemprop="dateCreated datePublished" datetime="2023-06-21T16:31:25+08:00">2023-06-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-25 15:39:44" itemprop="dateModified" datetime="2025-10-25T15:39:44+08:00">2025-10-25</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>按键精灵2014学习笔记<br>按键精灵2014的脚本是基于VB开发的，可以使用部分VB内置命令；按键精灵X的脚本是基于Lua开发的<br>源码的后缀名为<code>.Q</code>，但是文件中不仅包含了源码，还包含了文件属性，可以通过按键精灵2014的编辑器来修改和调试源码</p>
<span id="more"></span>

<h2 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// 注释内容</span><br><span class="line"></span><br><span class="line">&#x27; 注释内容</span><br></pre></td></tr></table></figure>

<h2 id="延时"><a href="#延时" class="headerlink" title="延时"></a>延时</h2><blockquote>
<p><code>&lt;num&gt;</code>：延迟的时间，单位毫秒</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Delay &lt;num&gt;</span><br></pre></td></tr></table></figure>

<h2 id="声明变量"><a href="#声明变量" class="headerlink" title="声明变量"></a>声明变量</h2><ul>
<li>按键精灵2014的变量名可以是中文</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dim 变量名</span><br></pre></td></tr></table></figure>

<h2 id="声明全局变量"><a href="#声明全局变量" class="headerlink" title="声明全局变量"></a>声明全局变量</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DimEnv 变量名</span><br></pre></td></tr></table></figure>

<h2 id="定义变量"><a href="#定义变量" class="headerlink" title="定义变量"></a>定义变量</h2><ul>
<li>为变量赋值</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = 变量值</span><br></pre></td></tr></table></figure>

<h2 id="定义用户变量"><a href="#定义用户变量" class="headerlink" title="定义用户变量"></a>定义用户变量</h2><ul>
<li>用于可以传递参数的小精灵传来的参数</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UserVar 变量名 = &quot;参数默认值&quot; &quot;提示信息&quot;</span><br></pre></td></tr></table></figure>

<h2 id="输出到控制台"><a href="#输出到控制台" class="headerlink" title="输出到控制台"></a>输出到控制台</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TracePrint 变量名</span><br></pre></td></tr></table></figure>

<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h4><ul>
<li>通过<code>&amp;</code>进行字符串拼接</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;文本内容&quot;&amp;&quot;文本内容&quot;</span><br></pre></td></tr></table></figure>

<h4 id="字符串分割"><a href="#字符串分割" class="headerlink" title="字符串分割"></a>字符串分割</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">字符串数组变量名 = Split(字符串, &quot;分割符&quot;)</span><br><span class="line"></span><br><span class="line">字符串数组第一个值 = 字符串数组变量名(0)</span><br></pre></td></tr></table></figure>

<h5 id="查找子字符串"><a href="#查找子字符串" class="headerlink" title="查找子字符串"></a>查找子字符串</h5><ul>
<li>查找子字符串在父字符串中的位置，如果没有找到返回0</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InStr(&quot;父字符串&quot;, &quot;子字符串&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="替换子字符串"><a href="#替换子字符串" class="headerlink" title="替换子字符串"></a>替换子字符串</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Replace(&quot;父字符串&quot;, &quot;旧的子字符串&quot;, &quot;新的子字符串&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="倒置字符串中的字符顺序"><a href="#倒置字符串中的字符顺序" class="headerlink" title="倒置字符串中的字符顺序"></a>倒置字符串中的字符顺序</h5><ul>
<li>返回倒置后的新字符串</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量 = StrReverse(&quot;字符串&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="截取字符串"><a href="#截取字符串" class="headerlink" title="截取字符串"></a>截取字符串</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mid(字符串, 开始截取下标, 步长)</span><br></pre></td></tr></table></figure>

<h3 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h3><h4 id="换行符"><a href="#换行符" class="headerlink" title="换行符"></a>换行符</h4><ul>
<li>光标移到下一行</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chr(10)</span><br></pre></td></tr></table></figure>

<ul>
<li>光标移到下一行开头</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Chr(13)</span><br></pre></td></tr></table></figure>

<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><h4 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">数组名 = Array(值, 值)</span><br></pre></td></tr></table></figure>

<h4 id="获取数组长度"><a href="#获取数组长度" class="headerlink" title="获取数组长度"></a>获取数组长度</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ubound(数组名)</span><br></pre></td></tr></table></figure>

<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><h3 id="比较运算符"><a href="#比较运算符" class="headerlink" title="比较运算符"></a>比较运算符</h3><ul>
<li><code>&lt;&gt;</code></li>
</ul>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><ul>
<li><code>And</code>、<code>Or</code>、<code>Not</code></li>
</ul>
<h2 id="循环语句"><a href="#循环语句" class="headerlink" title="循环语句"></a>循环语句</h2><h3 id="Where循环"><a href="#Where循环" class="headerlink" title="Where循环"></a>Where循环</h3><ul>
<li>如果无限循环，循环条件设置为<code>True</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">While 循环条件</span><br><span class="line">    ...</span><br><span class="line">Wend</span><br></pre></td></tr></table></figure>

<h3 id="For循环"><a href="#For循环" class="headerlink" title="For循环"></a>For循环</h3><blockquote>
<p><code>&lt;num&gt;</code>：循环次数</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">For &lt;num&gt;</span><br><span class="line">    ...</span><br><span class="line">Next</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">For 0 To 1</span><br><span class="line">    ...</span><br><span class="line">Next</span><br></pre></td></tr></table></figure>

<h2 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h2><h3 id="数值判断"><a href="#数值判断" class="headerlink" title="数值判断"></a>数值判断</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IF 条件 Then</span><br><span class="line">    ...</span><br><span class="line">ElseIf 条件</span><br><span class="line">    ...</span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h3 id="颜色判断"><a href="#颜色判断" class="headerlink" title="颜色判断"></a>颜色判断</h3><h4 id="获取鼠标当前位置的颜色值"><a href="#获取鼠标当前位置的颜色值" class="headerlink" title="获取鼠标当前位置的颜色值"></a>获取鼠标当前位置的颜色值</h4><ul>
<li>获取鼠标当前位置的6位十六进制颜色值</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = GetPixelColor(像素点横坐标, 像素点纵坐标)</span><br></pre></td></tr></table></figure>

<h4 id="定位找色"><a href="#定位找色" class="headerlink" title="定位找色"></a>定位找色</h4><blockquote>
<p><code>&lt;x&gt;</code>：x轴坐标<br><code>&lt;y&gt;</code>：y轴坐标<br><code>FFFFFF</code>：十六进制颜色值<br>0表示相同，1表示不相同，2表示相似</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IfColor &lt;x&gt;,&lt;y&gt;,&quot;FFFFFF&quot;,0 Then</span><br><span class="line">    ...</span><br><span class="line">Else</span><br><span class="line">    ...</span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h4 id="区域找色"><a href="#区域找色" class="headerlink" title="区域找色"></a>区域找色</h4><ul>
<li>在一个区域内从左上角开始找色，按照先从左再到右、先从上再到下的顺序</li>
</ul>
<blockquote>
<p><code>&lt;x_start&gt;,&lt;y_start&gt;</code>：选区左上角的横纵坐标<br><code>&lt;x_end&gt;,&lt;y_end&gt;</code>：选区右下角的横纵坐标<br><code>intX</code>：返回值，找到的结果x坐标，如果找不到就返回小于1的数<br><code>intY</code>：返回值，找到的结果y坐标，如果找不到就返回小于1的数 </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FindColor &lt;x_start&gt;,&lt;y_start&gt;,&lt;x_end&gt;,&lt;y_end&gt;,&quot;FFFFFF&quot;,intX,intY</span><br><span class="line">If intX &gt; 0 And intY &gt; 0 Then</span><br><span class="line">    ...</span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h5 id="更多配置"><a href="#更多配置" class="headerlink" title="更多配置"></a>更多配置</h5><blockquote>
<p><code>&lt;mod&gt;</code>：指定找色模式</p>
<blockquote>
<p><code>0</code>：从左上到右下<br><code>1</code>：从中心开始<br><code>2</code>：从右下到左上</p>
</blockquote>
<p><code>&lt;similarity&gt;</code>：指定颜色相似度，范围[0,1]</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FindColorEx &lt;x_start&gt;,&lt;y_start&gt;,&lt;x_end&gt;,&lt;y_end&gt;,&quot;FFFFFF&quot;,&lt;mod&gt;,&lt;similarity&gt;,intX,intY</span><br><span class="line">If intX &gt; 0 And intY &gt; 0 Then</span><br><span class="line">    ...</span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h3 id="图片判断"><a href="#图片判断" class="headerlink" title="图片判断"></a>图片判断</h3><ul>
<li>先将图片添加到附件</li>
</ul>
<p>按键精灵只能识别<code>.bmp</code>格式的位图<br>不能找单色图片<br>如果图片的四个角的像素点的颜色一样，则该图片中存在的所有该颜色都视为透明</p>
<ul>
<li>再在代码中引用图片</li>
</ul>
<blockquote>
<p><code>&lt;file_name&gt;.bmp</code>：附件中的图片名</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">FindPic &lt;x_start&gt;,&lt;y_start&gt;,&lt;x_end&gt;,&lt;y_end&gt;,&quot;&lt;file_name&gt;.bmp&quot;,&lt;similarity&gt;,intX,intY</span><br><span class="line">If intX &gt; 0 And intY &gt; 0 Then</span><br><span class="line">    ...</span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h4 id="查找标准色块数量"><a href="#查找标准色块数量" class="headerlink" title="查找标准色块数量"></a>查找标准色块数量</h4><blockquote>
<p>相似度：取值范围为[0,1]<br>颜色值：6位的十六进制颜色值，顺序是BGR</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.Color.CountBlockNum(左上角横坐标, 左上角纵坐标, 右下角横坐标, 右下角纵坐标, 颜色值, 相似度)</span><br></pre></td></tr></table></figure>

<h5 id="后台查找标准色块数量"><a href="#后台查找标准色块数量" class="headerlink" title="后台查找标准色块数量"></a>后台查找标准色块数量</h5><ul>
<li>同一种颜色形成的整体就是一个色块</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.Bkgnd.CountBlockNum(窗口句柄, 左上角横坐标, 左上角纵坐标, 右下角横坐标, 右下角纵坐标, 颜色值, 相似度)</span><br></pre></td></tr></table></figure>

<h5 id="后台查找标准色块位置"><a href="#后台查找标准色块位置" class="headerlink" title="后台查找标准色块位置"></a>后台查找标准色块位置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.Bkgnd.GetBlockRange(窗口句柄, 左上角横坐标, 左上角纵坐标, 右下角横坐标, 右下角纵坐标, 颜色值, 相似度)</span><br></pre></td></tr></table></figure>

<h2 id="操作鼠标"><a href="#操作鼠标" class="headerlink" title="操作鼠标"></a>操作鼠标</h2><h3 id="获取鼠标当前位置的坐标"><a href="#获取鼠标当前位置的坐标" class="headerlink" title="获取鼠标当前位置的坐标"></a>获取鼠标当前位置的坐标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GetCursorPos x, y</span><br></pre></td></tr></table></figure>

<h3 id="移动鼠标"><a href="#移动鼠标" class="headerlink" title="移动鼠标"></a>移动鼠标</h3><h4 id="绝对定位移动"><a href="#绝对定位移动" class="headerlink" title="绝对定位移动"></a>绝对定位移动</h4><ul>
<li>屏幕坐标系的原点为屏幕左上角，向右为x轴的正方向，向下为y轴的正方向</li>
</ul>
<blockquote>
<p><code>&lt;x&gt;</code>：x轴坐标<br><code>&lt;y&gt;</code>：y轴坐标</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MoveTo &lt;x&gt;,&lt;y&gt;</span><br></pre></td></tr></table></figure>

<h4 id="相对定位移动"><a href="#相对定位移动" class="headerlink" title="相对定位移动"></a>相对定位移动</h4><blockquote>
<p><code>&lt;x&gt;</code>：横坐标的增量，正数为向右，负数为向左<br><code>&lt;y&gt;</code>：纵坐标的增量，正数为向下，负数为向上</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MoveR &lt;x&gt;,&lt;y&gt;</span><br></pre></td></tr></table></figure>

<h3 id="左键单机"><a href="#左键单机" class="headerlink" title="左键单机"></a>左键单机</h3><blockquote>
<p><code>&lt;num&gt;</code>：单机次数</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">LeftClick &lt;num&gt;</span><br></pre></td></tr></table></figure>

<h2 id="操作键盘"><a href="#操作键盘" class="headerlink" title="操作键盘"></a>操作键盘</h2><h3 id="程序暂停等待按键"><a href="#程序暂停等待按键" class="headerlink" title="程序暂停等待按键"></a>程序暂停等待按键</h3><ul>
<li>按下非终止程序快捷键以外的键，程序才会继续运行</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WaitKey</span><br></pre></td></tr></table></figure>

<h4 id="获取按下的键码值"><a href="#获取按下的键码值" class="headerlink" title="获取按下的键码值"></a>获取按下的键码值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = WaitKey()</span><br></pre></td></tr></table></figure>

<h3 id="检测上次按过的键"><a href="#检测上次按过的键" class="headerlink" title="检测上次按过的键"></a>检测上次按过的键</h3><ul>
<li>获取键盘上一次按下的键码值，包括程序未运行时按下的按键</li>
<li>默认没有按键按下时得到的值为0</li>
<li>检测到按键后会立即将键码值赋值给变量，如果之后没有按键继续按下，变量值会恢复为0</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = GetLastKey()</span><br></pre></td></tr></table></figure>

<h3 id="输出字符串"><a href="#输出字符串" class="headerlink" title="输出字符串"></a>输出字符串</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SayString &quot;文本内容&quot;</span><br></pre></td></tr></table></figure>

<h4 id="后台输出字符串"><a href="#后台输出字符串" class="headerlink" title="后台输出字符串"></a>后台输出字符串</h4><ul>
<li>后台按下回车</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Bkgnd.SendString(句柄变量名, &quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="按下指定按键"><a href="#按下指定按键" class="headerlink" title="按下指定按键"></a>按下指定按键</h3><ul>
<li>按下回车</li>
</ul>
<blockquote>
<p><code>&lt;num&gt;</code>：按键按下次数</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KeyPress &quot;Enter&quot;, &lt;num&gt;</span><br></pre></td></tr></table></figure>

<h4 id="后台按下指定按键"><a href="#后台按下指定按键" class="headerlink" title="后台按下指定按键"></a>后台按下指定按键</h4><ul>
<li>后台按下回车</li>
</ul>
<blockquote>
<p>键码值</p>
<blockquote>
<p><code>13</code>：回车键</p>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Bkgnd.KeyPress(句柄变量名, 键码值)</span><br></pre></td></tr></table></figure>

<h4 id="字符转键码值"><a href="#字符转键码值" class="headerlink" title="字符转键码值"></a>字符转键码值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Asc(&quot;字符&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="弹出消息窗"><a href="#弹出消息窗" class="headerlink" title="弹出消息窗"></a>弹出消息窗</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MessageBox &quot;文本内容&quot;</span><br></pre></td></tr></table></figure>

<h2 id="屏幕输出文本框"><a href="#屏幕输出文本框" class="headerlink" title="屏幕输出文本框"></a>屏幕输出文本框</h2><ul>
<li>文本字号为16像素</li>
<li>文本框的颜色为白底</li>
<li>超出文本框的文字会被隐藏</li>
</ul>
<blockquote>
<p>颜色值：6位的十六进制颜色值，顺序是BGR</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Msg.ShowScrTXT(文本框左上角横坐标, 文本框左上角纵坐标, 文本框右下角横坐标, 文本框右下角纵坐标, &quot;文本内容&quot;, 颜色值)</span><br></pre></td></tr></table></figure>

<h3 id="清除文本框"><a href="#清除文本框" class="headerlink" title="清除文本框"></a>清除文本框</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plugin.Msg.HideSrcTXT</span><br></pre></td></tr></table></figure>

<h2 id="状态栏图标气泡"><a href="#状态栏图标气泡" class="headerlink" title="状态栏图标气泡"></a>状态栏图标气泡</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Msg.Tips(&quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="子程序"><a href="#子程序" class="headerlink" title="子程序"></a>子程序</h2><h3 id="定义子程序"><a href="#定义子程序" class="headerlink" title="定义子程序"></a>定义子程序</h3><ul>
<li>子程序名可以是中文</li>
</ul>
<h4 id="无参"><a href="#无参" class="headerlink" title="无参"></a>无参</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sub 子程序名</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h4 id="有参"><a href="#有参" class="headerlink" title="有参"></a>有参</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Sub 子程序名(形参名, 形参名)</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h3 id="调用子程序"><a href="#调用子程序" class="headerlink" title="调用子程序"></a>调用子程序</h3><h4 id="无参-1"><a href="#无参-1" class="headerlink" title="无参"></a>无参</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call 子程序名</span><br></pre></td></tr></table></figure>

<h4 id="有参-1"><a href="#有参-1" class="headerlink" title="有参"></a>有参</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call 子程序名(值, 值)</span><br></pre></td></tr></table></figure>

<h2 id="窗口句柄"><a href="#窗口句柄" class="headerlink" title="窗口句柄"></a>窗口句柄</h2><h3 id="获取窗口句柄"><a href="#获取窗口句柄" class="headerlink" title="获取窗口句柄"></a>获取窗口句柄</h3><h4 id="通过鼠标的位置获取窗口句柄"><a href="#通过鼠标的位置获取窗口句柄" class="headerlink" title="通过鼠标的位置获取窗口句柄"></a>通过鼠标的位置获取窗口句柄</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">句柄变量名 = Plugin.Window.MousePoit()</span><br></pre></td></tr></table></figure>

<h4 id="通过类名获取窗口句柄"><a href="#通过类名获取窗口句柄" class="headerlink" title="通过类名获取窗口句柄"></a>通过类名获取窗口句柄</h4><h5 id="获取根级的窗口句柄"><a href="#获取根级的窗口句柄" class="headerlink" title="获取根级的窗口句柄"></a>获取根级的窗口句柄</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">句柄变量名 = Plugin.Window.Find(&quot;窗口类名&quot;, &quot;窗口标题&quot;)</span><br></pre></td></tr></table></figure>

<ul>
<li>如果模糊查找，可以不给窗口标题参数</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">句柄变量名 = Plugin.Window.Find(&quot;窗口类名&quot;, 0)</span><br></pre></td></tr></table></figure>

<h5 id="获取子级的窗口句柄"><a href="#获取子级的窗口句柄" class="headerlink" title="获取子级的窗口句柄"></a>获取子级的窗口句柄</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">子窗口句柄变量名 = Plugin.Window.FindEx(句柄变量名, 0, 0, 0)</span><br></pre></td></tr></table></figure>

<h3 id="通过窗口句柄获取窗口位置"><a href="#通过窗口句柄获取窗口位置" class="headerlink" title="通过窗口句柄获取窗口位置"></a>通过窗口句柄获取窗口位置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">窗口位置变量 = Plugin.Window.GetWindowRect(句柄变量名)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">左上角横坐标|左上角纵坐标|右下角横坐标|右下角纵坐标</span><br></pre></td></tr></table></figure>

<h3 id="通过窗口句柄操作鼠标"><a href="#通过窗口句柄操作鼠标" class="headerlink" title="通过窗口句柄操作鼠标"></a>通过窗口句柄操作鼠标</h3><h4 id="单机左键"><a href="#单机左键" class="headerlink" title="单机左键"></a>单机左键</h4><ul>
<li>这种方式操作鼠标时，无论是否在屏幕内，无论是否在前台，都可以正常执行点击</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Bkgnd.LeftClick(句柄变量名, 相对于窗口左上角的横坐标, 相对于窗口左上角的纵坐标)</span><br></pre></td></tr></table></figure>

<h2 id="生成随机数"><a href="#生成随机数" class="headerlink" title="生成随机数"></a>生成随机数</h2><ul>
<li>生成随机数范围为[0,1)的随机数</li>
</ul>
<blockquote>
<p><code>&lt;seed&gt;</code>：随机数种子类型</p>
<blockquote>
<p>大于0、省略：将生成的随机数列表中的下一个随机数作为随机数种子<br>小于0：使用该值作为随机数种子，每次都相同<br><code>0</code>：使用最近生成的数作为随机数种子</p>
</blockquote>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Rnd()</span><br></pre></td></tr></table></figure>

<h3 id="生成指定范围的随机数"><a href="#生成指定范围的随机数" class="headerlink" title="生成指定范围的随机数"></a>生成指定范围的随机数</h3><blockquote>
<p><code>&lt;max&gt;</code>：最大值<br><code>&lt;min&gt;</code>：最小值</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Int((&lt;max&gt; - &lt;min&gt; + 1) * Rnd + &lt;min&gt;)</span><br></pre></td></tr></table></figure>

<h3 id="重置随机数种子"><a href="#重置随机数种子" class="headerlink" title="重置随机数种子"></a>重置随机数种子</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Randomize</span><br></pre></td></tr></table></figure>

<h2 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h2><h3 id="脚本停止运行事件"><a href="#脚本停止运行事件" class="headerlink" title="脚本停止运行事件"></a>脚本停止运行事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Sub OnScriptExit()</span><br><span class="line"></span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h3 id="点击事件"><a href="#点击事件" class="headerlink" title="点击事件"></a>点击事件</h3><blockquote>
<p><code>Form1</code>：第一个窗口<br><code>Button1</code>：第一个按钮</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Event Form1.Button1.Click</span><br><span class="line">    ...</span><br><span class="line">End Event</span><br></pre></td></tr></table></figure>

<h3 id="窗体加载事件"><a href="#窗体加载事件" class="headerlink" title="窗体加载事件"></a>窗体加载事件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Event Form1.Load</span><br><span class="line">    ...</span><br><span class="line">End Event</span><br></pre></td></tr></table></figure>

<h2 id="QUI组件"><a href="#QUI组件" class="headerlink" title="QUI组件"></a>QUI组件</h2><h3 id="文本框"><a href="#文本框" class="headerlink" title="文本框"></a>文本框</h3><h4 id="获取文本框内容"><a href="#获取文本框内容" class="headerlink" title="获取文本框内容"></a>获取文本框内容</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Form1.ImpotBox.Text</span><br></pre></td></tr></table></figure>

<h5 id="转换为整型"><a href="#转换为整型" class="headerlink" title="转换为整型"></a>转换为整型</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Int(Form1.ImpotBox.Text)</span><br></pre></td></tr></table></figure>

<h4 id="修改文本框内容"><a href="#修改文本框内容" class="headerlink" title="修改文本框内容"></a>修改文本框内容</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Form1.ImpotBox.Text = &quot;文本内容&quot;</span><br></pre></td></tr></table></figure>

<h3 id="下拉列表"><a href="#下拉列表" class="headerlink" title="下拉列表"></a>下拉列表</h3><h4 id="定义所有选项"><a href="#定义所有选项" class="headerlink" title="定义所有选项"></a>定义所有选项</h4><h5 id="前端显示"><a href="#前端显示" class="headerlink" title="前端显示"></a>前端显示</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Form1.ComboBox1.List = &quot;是|否&quot;</span><br></pre></td></tr></table></figure>

<h5 id="后段实际数据"><a href="#后段实际数据" class="headerlink" title="后段实际数据"></a>后段实际数据</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">subfix = Array(true, false)</span><br><span class="line">If subfix(Form1.ComboBox1.ListIndex) == true Then</span><br><span class="line"></span><br><span class="line">End If</span><br></pre></td></tr></table></figure>

<h4 id="定义默认选项"><a href="#定义默认选项" class="headerlink" title="定义默认选项"></a>定义默认选项</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Form1.ComboBox1.ListIndex = 0</span><br></pre></td></tr></table></figure>

<h3 id="文件选择"><a href="#文件选择" class="headerlink" title="文件选择"></a>文件选择</h3><ul>
<li>弹出一个文件选择窗口</li>
<li>返回选择的文件的绝对路径</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.File.SelectFile()</span><br></pre></td></tr></table></figure>

<h2 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h2><blockquote>
<p><code>&lt;file&gt;</code>：文件绝对路径</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RunApp &lt;file&gt;</span><br></pre></td></tr></table></figure>

<h2 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h2><h3 id="启动线程"><a href="#启动线程" class="headerlink" title="启动线程"></a>启动线程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">BeginThread 子程序名1</span><br><span class="line">BeginThread 子程序名2</span><br><span class="line"></span><br><span class="line">Sub 子程序名1</span><br><span class="line">    ...</span><br><span class="line">End Sub</span><br><span class="line"></span><br><span class="line">Sub 子程序名2</span><br><span class="line">    ...</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>

<h4 id="获取线程ID"><a href="#获取线程ID" class="headerlink" title="获取线程ID"></a>获取线程ID</h4><ul>
<li>启动线程后会返回线程ID</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">线程ID = BeginThread 子程序名</span><br></pre></td></tr></table></figure>

<h3 id="停止指定线程"><a href="#停止指定线程" class="headerlink" title="停止指定线程"></a>停止指定线程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">StopThread 线程ID</span><br></pre></td></tr></table></figure>

<h3 id="继续线程"><a href="#继续线程" class="headerlink" title="继续线程"></a>继续线程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ContinueThread 线程ID</span><br></pre></td></tr></table></figure>

<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><h3 id="小精灵配置文件"><a href="#小精灵配置文件" class="headerlink" title="小精灵配置文件"></a>小精灵配置文件</h3><ul>
<li>在小精灵同级目录下创建<code>uservar.ini</code>配置文件</li>
</ul>
<blockquote>
<p><code>&lt;uuid&gt;</code>：UUID<br><code>&lt;value&gt;</code>：值</p>
</blockquote>
<figure class="highlight ini"><figcaption><span>uservar.ini</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[&lt;uuid&gt;]</span></span><br><span class="line"><span class="attr">Form1.InputBox1.Text</span>=&lt;value&gt;</span><br></pre></td></tr></table></figure>

<h3 id="写入自定义配置文件"><a href="#写入自定义配置文件" class="headerlink" title="写入自定义配置文件"></a>写入自定义配置文件</h3><ul>
<li>配置文件不存在则会自动创建</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.WriteINI(&quot;小节&quot;, &quot;键&quot;, &quot;值&quot;, &quot;C:\Config.ini&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="读取自定义配置文件"><a href="#读取自定义配置文件" class="headerlink" title="读取自定义配置文件"></a>读取自定义配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.File.ReadINI(&quot;小节&quot;, &quot;键&quot;, &quot;C:\Config.ini&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="获取当前时间"><a href="#获取当前时间" class="headerlink" title="获取当前时间"></a>获取当前时间</h2><h3 id="从当前系统获取时间"><a href="#从当前系统获取时间" class="headerlink" title="从当前系统获取时间"></a>从当前系统获取时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.Sys.GetDateTime()</span><br></pre></td></tr></table></figure>

<h3 id="从网络获取时间"><a href="#从网络获取时间" class="headerlink" title="从网络获取时间"></a>从网络获取时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = lib.网络.获取网络时间()</span><br></pre></td></tr></table></figure>

<h2 id="字符串作为命令执行"><a href="#字符串作为命令执行" class="headerlink" title="字符串作为命令执行"></a>字符串作为命令执行</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Execute(&quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="读写文件"><a href="#读写文件" class="headerlink" title="读写文件"></a>读写文件</h2><h3 id="打开文件"><a href="#打开文件" class="headerlink" title="打开文件"></a>打开文件</h3><ul>
<li>如果打开成功会返回文件句柄</li>
<li>如果打开失败会返回-1</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件句柄 = Plugin.File.Open(&quot;文件路径&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="关闭文件"><a href="#关闭文件" class="headerlink" title="关闭文件"></a>关闭文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.Close(文件句柄)</span><br></pre></td></tr></table></figure>

<h3 id="读取文件"><a href="#读取文件" class="headerlink" title="读取文件"></a>读取文件</h3><h4 id="按行读取文件"><a href="#按行读取文件" class="headerlink" title="按行读取文件"></a>按行读取文件</h4><ul>
<li>行首可能会包含上一行末尾的换行符</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.File.ReadLine(文件句柄)</span><br><span class="line">While 句柄变量名 &lt;&gt; &quot;&quot;</span><br><span class="line">    变量名 = Plugin.File.ReadLine(文件句柄)</span><br><span class="line">Wend</span><br></pre></td></tr></table></figure>

<h3 id="设置文件读写位置"><a href="#设置文件读写位置" class="headerlink" title="设置文件读写位置"></a>设置文件读写位置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.SeekFile(文件句柄, 位置)</span><br></pre></td></tr></table></figure>

<h3 id="获取文件内容长度"><a href="#获取文件内容长度" class="headerlink" title="获取文件内容长度"></a>获取文件内容长度</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.File.GetFileLength(&quot;文件路径&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h3><h4 id="文件末尾追加一行文本"><a href="#文件末尾追加一行文本" class="headerlink" title="文件末尾追加一行文本"></a>文件末尾追加一行文本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.WriteFileFx(&quot;文件路径&quot;, &quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="在当前光标处写入文本"><a href="#在当前光标处写入文本" class="headerlink" title="在当前光标处写入文本"></a>在当前光标处写入文本</h4><ul>
<li>写入时会进行覆盖操作，且只覆盖新的数据的长度</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.WriteFile(&quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="在文件末尾追加写入"><a href="#在文件末尾追加写入" class="headerlink" title="在文件末尾追加写入"></a>在文件末尾追加写入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件内容长度 = Plugin.File.GetFileLength(&quot;文件路径&quot;)</span><br><span class="line">Call Plugin.File.SeekFile(文件句柄, 文件内容长度)</span><br><span class="line">Call Plugin.File.WriteFile(&quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h4 id="在当前光标处写入一行文本"><a href="#在当前光标处写入一行文本" class="headerlink" title="在当前光标处写入一行文本"></a>在当前光标处写入一行文本</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.File.WriteLine(&quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h5 id="在文件末尾追加写入-1"><a href="#在文件末尾追加写入-1" class="headerlink" title="在文件末尾追加写入"></a>在文件末尾追加写入</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">文件内容长度 = Plugin.File.GetFileLength(&quot;文件路径&quot;)</span><br><span class="line">Call Plugin.File.SeekFile(文件句柄, 文件内容长度)</span><br><span class="line">Call Plugin.File.WriteLine(Chr(13) &amp; &quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="读写Excel文件"><a href="#读写Excel文件" class="headerlink" title="读写Excel文件"></a>读写Excel文件</h2><h3 id="打开Excel文件"><a href="#打开Excel文件" class="headerlink" title="打开Excel文件"></a>打开Excel文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Office.OpenXls(&quot;文件路径&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="关闭文件-1"><a href="#关闭文件-1" class="headerlink" title="关闭文件"></a>关闭文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Call Plugin.Office.CloseXls()</span><br></pre></td></tr></table></figure>

<h3 id="写入文件-1"><a href="#写入文件-1" class="headerlink" title="写入文件"></a>写入文件</h3><blockquote>
<p><code>工作簿下标</code>：从1开始<br><code>单元格行的下标</code>：从1开始<br><code>单元格列的下标</code>：从1开始</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plugin.Office.Write(工作簿下标, 单元格行的下标, 单元格列的下标, &quot;文本内容&quot;)</span><br></pre></td></tr></table></figure>

<h2 id="发送HTTP请求"><a href="#发送HTTP请求" class="headerlink" title="发送HTTP请求"></a>发送HTTP请求</h2><h3 id="Get"><a href="#Get" class="headerlink" title="Get"></a>Get</h3><blockquote>
<p><code>False</code>：是否是异步请求</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Set xPost = createObject(&quot;Msxml2.ServerXMLHTTP3.0&quot;)</span><br><span class="line">xPost.Open &quot;Get&quot;, &quot;http://127.0.0.1:80/?key=value&quot;, False</span><br><span class="line">xPost.Send</span><br><span class="line">Delay 10</span><br><span class="line">If xPost.readyState = 4 Then</span><br><span class="line">    变量名 = xPost.responsetext</span><br><span class="line">End If</span><br><span class="line">xPost.abort</span><br><span class="line">Set xPost = Notbing</span><br></pre></td></tr></table></figure>

<h3 id="Post"><a href="#Post" class="headerlink" title="Post"></a>Post</h3><blockquote>
<p><code>False</code>：是否是异步请求</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Set xPost = createObject(&quot;Msxml2.ServerXMLHTTP3.0&quot;)</span><br><span class="line">xPost.Open &quot;Post&quot;, &quot;http://127.0.0.1:80/&quot;, False</span><br><span class="line">xPost.Send(&quot;key=value&quot;)</span><br><span class="line">Delay 10</span><br><span class="line">If xPost.readyState = 4 Then</span><br><span class="line">    变量名 = xPost.responsetext</span><br><span class="line">End If</span><br><span class="line">xPost.abort</span><br><span class="line">Set xPost = Notbing</span><br></pre></td></tr></table></figure>

<h2 id="保存截图"><a href="#保存截图" class="headerlink" title="保存截图"></a>保存截图</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Plugin.Pic.PrintScreen(左上角横坐标, 左上角纵坐标, 右下角横坐标, 右下角纵坐标, 图片保存路径)</span><br></pre></td></tr></table></figure>

<h2 id="操作剪贴板"><a href="#操作剪贴板" class="headerlink" title="操作剪贴板"></a>操作剪贴板</h2><h3 id="获取剪贴板内容"><a href="#获取剪贴板内容" class="headerlink" title="获取剪贴板内容"></a>获取剪贴板内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 = Plugin.Sys.GetCLB()</span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><ul>
<li>函数和子程序基本相同</li>
<li>函数可以有返回值，子程序没有返回值</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Function 函数名</span><br><span class="line">    ...</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure>

<ul>
<li>为函数名同名的变量名赋值，即可赋值给返回值</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Function 函数名</span><br><span class="line">    函数名 = 返回值</span><br><span class="line">End Function</span><br></pre></td></tr></table></figure>

<h2 id="命令库"><a href="#命令库" class="headerlink" title="命令库"></a>命令库</h2><ul>
<li><p>在命令库右键-&gt;<code>新建</code>-&gt;定义命令名称-&gt;<code>确定</code></p>
</li>
<li><p>在命令代码区中添加多个子程序或函数</p>
</li>
<li><p>调用命令</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Lib.命令库名.命令名(参数列表)</span><br></pre></td></tr></table></figure>

<h2 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="/302.html?target=https://www.bilibili.com/video/BV11x411a7Hw/">哔哩哔哩——酷玩蚊仔</a><br><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1S34y1a75p/">哔哩哔哩——沧桑大侠</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div><svg class="coin" width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.045 25.5454C7.69377 25.5454 2.54504 20.3967 2.54504 14.0454C2.54504 7.69413 7.69377 2.54541 14.045 2.54541C20.3963 2.54541 25.545 7.69413 25.545 14.0454C25.545 17.0954 24.3334 20.0205 22.1768 22.1771C20.0201 24.3338 17.095 25.5454 14.045 25.5454ZM9.66202 6.81624H18.2761C18.825 6.81624 19.27 7.22183 19.27 7.72216C19.27 8.22248 18.825 8.62807 18.2761 8.62807H14.95V10.2903C17.989 10.4444 20.3766 12.9487 20.3855 15.9916V17.1995C20.3854 17.6997 19.9799 18.1052 19.4796 18.1052C18.9793 18.1052 18.5738 17.6997 18.5737 17.1995V15.9916C18.5667 13.9478 16.9882 12.2535 14.95 12.1022V20.5574C14.95 21.0577 14.5444 21.4633 14.0441 21.4633C13.5437 21.4633 13.1382 21.0577 13.1382 20.5574V12.1022C11.1 12.2535 9.52148 13.9478 9.51448 15.9916V17.1995C9.5144 17.6997 9.10883 18.1052 8.60856 18.1052C8.1083 18.1052 7.70273 17.6997 7.70265 17.1995V15.9916C7.71158 12.9487 10.0992 10.4444 13.1382 10.2903V8.62807H9.66202C9.11309 8.62807 8.66809 8.22248 8.66809 7.72216C8.66809 7.22183 9.11309 6.81624 9.66202 6.81624Z" fill="currentColor"></path></svg></div>
  <button>
    储钱罐
  </button>
  <div class="post-reward">
      <div>
        <img src="/assets/images/reward/images/wxpay.png" alt="57uv6Z6g 微信支付">
        <span>微信支付</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/alipay.png" alt="57uv6Z6g 支付宝">
        <span>支付宝</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/qqpay.png" alt="57uv6Z6g qqpay">
        <span>qqpay</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/bitcoin.png" alt="57uv6Z6g 比特币">
        <span>比特币</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/ethereum.png" alt="57uv6Z6g ethereum">
        <span>ethereum</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/monero.png" alt="57uv6Z6g monero">
        <span>monero</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/paypal.png" alt="57uv6Z6g 贝宝">
        <span>贝宝</span>
      </div>

  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/06/20/Go%E8%AF%AD%E8%A8%80%E5%B0%86Markdown%E8%BD%AC%E6%8D%A2%E4%B8%BAHTML/" rel="prev" title="【笔记】Go语言将Markdown转换为HTML">
                  <i class="fa fa-angle-left"></i> 【笔记】Go语言将Markdown转换为HTML
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/06/21/%E9%80%9A%E8%BF%87Docker%E9%83%A8%E7%BD%B2Alist/" rel="next" title="【笔记】通过Docker部署Alist">
                  【笔记】通过Docker部署Alist <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments"><div id="twikoo-comments"></div></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">57uv6Z6g</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>
<div id="site-time"></div>


<div id="current-visitors-count"></div>


<div id="site-badge"></div>


<div id="loading-door-left"></div>
<div id="loading-door-right"></div>
<a id="loading-door-a" href="javascript:loadingDoorOpen();">芝麻开门</a>


<div id="waifu">
  <div id="waifu-tips"></div>
  <canvas id="live2d" width="800" height="800"></canvas>
</div>
<div id="waifu-toggle">
  <span>看板娘</span>
</div>


<link rel="stylesheet" href="/dist/bundle.css">


<script src="/dist/bundle.js"></script>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="twikoo" type="application/json">{"enable":true,"visitor":false,"envId":"https://twikoo.loli.fj.cn","jsUrl":"https://unpkg.com/twikoo@1.6.44/dist/twikoo.min.js","el":"#twikoo-comments"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      CONFIG.twikoo.jsUrl || 'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});
</script>
<style>
.post-block, .comments {
  overflow: visible;
}
.tk-owo-emotion {
  display: inline-block;
}
</style>

</body>
</html>
