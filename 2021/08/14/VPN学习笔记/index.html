<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicon-package/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-package/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-package/favicon-16x16.png">
  <link rel="mask-icon" href="/assets/images/favicon-package/safari-pinned-tab.svg" color="#222">
  <link rel="manifest" href="/assets/images/favicon-package/site.webmanifest">
  <meta name="google-site-verification" content="qIz-Tg08U6gyN_53z89yii0ZmKx2avfsO-iyOWhsRx8">
  <meta name="msvalidate.01" content="096F3D01D2AA04148F10750CD4566535">
  <meta name="yandex-verification" content="43f790b7e38394a4">
  <meta name="baidu-site-verification" content="codeva-LMZoUaXjJl">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="/lib/@fortawesome/fontawesome-free/css/all.min.css" integrity="sha256-dABdfBfUoC8vJUBOwGVdm8L9qlMWaHTIfXt+7GnZCIo=" crossorigin="anonymous">
  <link rel="stylesheet" href="/lib/animate.css/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"loli.fj.cn","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.23.2","exturl":false,"sidebar":{"position":"right","width_expanded":320,"width_dual_column":240,"display":"always","padding":18,"offset":12},"hljswrap":true,"codeblock":{"theme":{"light":"atom-one-light","dark":"atom-one-dark"},"prism":{"light":"prism","dark":"prism-dark"},"copy_button":{"enable":true,"style":"mac"},"fold":{"enable":true,"height":500},"language":true},"bookmark":{"enable":true,"color":"#222","save":"manual"},"mediumzoom":true,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js" defer></script>

    <meta name="description" content="前言VPN（Virtual Private Network）虚拟专有网络VPN可以在互联网上安全的传输数据，通过PKI技术保证数据的安全">
<meta property="og:type" content="article">
<meta property="og:title" content="【笔记】VPN学习笔记">
<meta property="og:url" content="https://loli.fj.cn/2021/08/14/VPN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="57uv6Z6g55qE5Y2a5a6i">
<meta property="og:description" content="前言VPN（Virtual Private Network）虚拟专有网络VPN可以在互联网上安全的传输数据，通过PKI技术保证数据的安全">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-14T10:58:11.000Z">
<meta property="article:modified_time" content="2025-10-25T07:39:44.930Z">
<meta property="article:author" content="57uv6Z6g">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://loli.fj.cn/2021/08/14/VPN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://loli.fj.cn/2021/08/14/VPN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/","path":"2021/08/14/VPN学习笔记/","title":"【笔记】VPN学习笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>【笔记】VPN学习笔记 | 57uv6Z6g55qE5Y2a5a6i</title>
  






  <script async defer data-website-id="981ed5a0-eea5-4426-a8a9-c16a789ccc3f" src="https://umami.loli.fj.cn/script.js" data-host-url="https://umami.loli.fj.cn/"></script>


  
  <script src="/lib/animejs/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous" defer></script>
  <script src="/lib/@next-theme/pjax/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous" defer></script>
  <script src="/lib/medium-zoom/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous" defer></script>
  <script src="/lib/pangu/dist/browser/pangu.umd.js" integrity="sha256-erngBMP3zzoIM6eqQ8dmrReh2vqCRgWmORroIfVoDlE=" crossorigin="anonymous" defer></script>
<script src="/js/utils.js" defer></script><script src="/js/motion.js" defer></script><script src="/js/sidebar.js" defer></script><script src="/js/next-boot.js" defer></script><script src="/js/bookmark.js" defer></script><script src="/js/pjax.js" defer></script>

  <script src="/lib/hexo-generator-searchdb/dist/search.js" integrity="sha256-xFC6PJ82SL9b3WkGjFavNiA9gm5z6UBxWPiu4CYjptg=" crossorigin="anonymous" defer></script>
<script src="/js/third-party/search/local-search.js" defer></script>







  
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"/lib/mathjax/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js" defer></script>



  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="57uv6Z6g55qE5Y2a5a6i" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">57uv6Z6g55qE5Y2a5a6i</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">MS4wLjABAAAA5qMD8Gzdcgq7HXUOviKB59i0-ybJ59jJvNzyaPt5XOsVNqP6DU7WLcoAXvdxvYdp💗<br><font color="red">本站所有文章仅作技术研究，请勿非法破坏，请遵守相关法律法规，后果自负</font></p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-links"><a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a></li><li class="menu-item menu-item-reward"><a href="/reward/" rel="section"><i class="fa fa-hand-holding-heart fa-fw"></i>赞助</a></li><li class="menu-item menu-item-command"><a href="/command/" rel="section"><i class="fa fa-book fa-fw"></i>指令</a></li><li class="menu-item menu-item-contribute"><a href="/contribute/" rel="section"><i class="fa fa-chart-line fa-fw"></i>贡献</a></li><li class="menu-item menu-item-rss"><a href="/atom.xml" rel="section"><i class="fa fa-rss fa-fw"></i>订阅</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

<link rel="manifest" href="/assets/images/favicon-package/site.webmanifest">

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VPN%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">2.</span> <span class="nav-text">VPN的分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VPN%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF"><span class="nav-number">3.</span> <span class="nav-text">VPN隧道技术</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%A0%E8%BE%93%E6%A8%A1%E5%BC%8F"><span class="nav-number">3.1.</span> <span class="nav-text">传输模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%A7%E9%81%93%E6%A8%A1%E5%BC%8F%EF%BC%88%E7%BC%BA%E7%9C%81%E5%80%BC%EF%BC%89"><span class="nav-number">3.2.</span> <span class="nav-text">隧道模式（缺省值）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AEIPsecVPN%E7%9A%84%E5%91%BD%E4%BB%A4%EF%BC%88%E7%82%B9%E5%88%B0%E7%82%B9VPN%EF%BC%89"><span class="nav-number">4.</span> <span class="nav-text">配置IPsecVPN的命令（点到点VPN）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%A1%E7%90%86%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.1.</span> <span class="nav-text">管理连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E5%85%A5%E4%BC%A0%E8%BE%93%E7%BA%A7%E9%85%8D%E7%BD%AE%E6%A8%A1%E5%BC%8F"><span class="nav-number">4.1.1.</span> <span class="nav-text">进入传输级配置模式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%EF%BC%88%E5%8F%8C%E6%96%B9%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-number">4.1.2.</span> <span class="nav-text">配置加密算法（双方一致）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%AE%8C%E6%95%B4%E6%80%A7%E7%AE%97%E6%B3%95%EF%BC%88%E5%8F%8C%E6%96%B9%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-number">4.1.3.</span> <span class="nav-text">配置完整性算法（双方一致）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E9%95%BF%E5%BA%A6%EF%BC%88%E5%8F%8C%E6%96%B9%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-number">4.1.4.</span> <span class="nav-text">配置非对称加密算法的长度（双方一致）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E4%BD%BF%E7%94%A8%E5%85%B1%E4%BA%AB%E5%AF%86%E9%92%A5%EF%BC%88%E5%8F%8C%E6%96%B9%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-number">4.1.5.</span> <span class="nav-text">配置使用共享密钥（双方一致）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%A4%B1%E6%95%88%E6%97%B6%E9%97%B4%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">4.1.6.</span> <span class="nav-text">配置失效时间（可选）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9B%E8%A1%8C%E5%8D%8F%E5%95%86"><span class="nav-number">4.1.7.</span> <span class="nav-text">进行协商</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.2.</span> <span class="nav-text">数据连接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89VPN%E8%A7%A6%E5%8F%91%E6%B5%81%E9%87%8F"><span class="nav-number">4.2.1.</span> <span class="nav-text">定义VPN触发流量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%8A%A0%E5%AF%86%E5%8F%8A%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F%EF%BC%88%E5%8F%8C%E6%96%B9%E4%B8%80%E8%87%B4%EF%BC%89"><span class="nav-number">4.2.2.</span> <span class="nav-text">定义加密及认证方式（双方一致）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E9%98%B6%E6%AE%B5"><span class="nav-number">4.3.</span> <span class="nav-text">应用阶段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAMAP%E6%98%A0%E5%B0%84%E8%A1%A8"><span class="nav-number">4.3.1.</span> <span class="nav-text">创建MAP映射表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%B9%E9%85%8DVPN%E6%B5%81%E9%87%8F"><span class="nav-number">4.3.2.</span> <span class="nav-text">匹配VPN流量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%8A%A0%E5%AF%86%E5%8F%8A%E8%AE%A4%E8%AF%81%E6%96%B9%E5%BC%8F"><span class="nav-number">4.3.3.</span> <span class="nav-text">匹配加密及认证方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E5%AF%B9%E6%96%B9%E7%9A%84%E5%85%AC%E7%BD%91IP"><span class="nav-number">4.3.4.</span> <span class="nav-text">配置对方的公网IP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%86MAP%E8%A1%A8%E5%BA%94%E7%94%A8%E5%88%B0%E5%A4%96%E7%BD%91%E7%AB%AF%E5%8F%A3"><span class="nav-number">4.3.5.</span> <span class="nav-text">将MAP表应用到外网端口</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%91%BD%E4%BB%A4"><span class="nav-number">4.4.</span> <span class="nav-text">查看命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%B6%E6%AE%B51%E7%9A%84%E7%8A%B6%E6%80%81"><span class="nav-number">4.4.1.</span> <span class="nav-text">查看阶段1的状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%B6%E6%AE%B52%E7%9A%84%E7%8A%B6%E6%80%81"><span class="nav-number">4.4.2.</span> <span class="nav-text">查看阶段2的状态</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%B6%E6%AE%B51%E7%9A%84%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE%E9%9B%86"><span class="nav-number">4.4.3.</span> <span class="nav-text">查看阶段1的策略配置集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E9%98%B6%E6%AE%B52%E7%9A%84%E7%AD%96%E7%95%A5%E9%85%8D%E7%BD%AE%E9%9B%86"><span class="nav-number">4.4.4.</span> <span class="nav-text">查看阶段2的策略配置集</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%85%8D%E7%BD%AESSL-VPN%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%91%BD%E4%BB%A4%EF%BC%88%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AEVPN%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">配置SSL VPN服务器的命令（远程访问VPN）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%8C%E6%88%90"><span class="nav-number">6.</span> <span class="nav-text">完成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-number">7.</span> <span class="nav-text">参考文献</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="57uv6Z6g"
      src="/assets/images/avatar.gif">
  <p class="site-author-name" itemprop="name">57uv6Z6g</p>
  <div class="site-description" itemprop="description">5o2V5o2J5LiA5Y+q54ix5oqY6IW+55qE57uv6Z6g</div>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:00-isomer-cabbies@icloud.com" title="E-Mail → mailto:00-isomer-cabbies@icloud.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/LittleSweetCookie" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;LittleSweetCookie" rel="noopener me" target="_blank"><i class="fab fa-telegram fa-fw"></i>Telegram</a>
      </span>
  </div>

<div id="aplayer-app"></div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://loli.fj.cn/2021/08/14/VPN%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.gif">
      <meta itemprop="name" content="57uv6Z6g">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="57uv6Z6g55qE5Y2a5a6i">
      <meta itemprop="description" content="5o2V5o2J5LiA5Y+q54ix5oqY6IW+55qE57uv6Z6g">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="【笔记】VPN学习笔记 | 57uv6Z6g55qE5Y2a5a6i">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          【笔记】VPN学习笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-08-14 18:58:11" itemprop="dateCreated datePublished" datetime="2021-08-14T18:58:11+08:00">2021-08-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2025-10-25 15:39:44" itemprop="dateModified" datetime="2025-10-25T15:39:44+08:00">2025-10-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0%E6%8C%87%E5%8C%97/" itemprop="url" rel="index"><span itemprop="name">计算机网络学习指北</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>VPN（Virtual Private Network）虚拟专有网络<br>VPN可以在互联网上安全的传输数据，通过PKI技术保证数据的安全</p>
<span id="more"></span>

<h2 id="VPN的分类"><a href="#VPN的分类" class="headerlink" title="VPN的分类"></a>VPN的分类</h2><ul>
<li>远程访问VPN</li>
</ul>
<p>一般用在个人对企业内部的安全连接</p>
<ul>
<li>点到点VPN</li>
</ul>
<p>一般用在企业对企业的安全连接</p>
<h2 id="VPN隧道技术"><a href="#VPN隧道技术" class="headerlink" title="VPN隧道技术"></a>VPN隧道技术</h2><h3 id="传输模式"><a href="#传输模式" class="headerlink" title="传输模式"></a>传输模式</h3><ul>
<li>只加密上层，不加密私有IP包头，相比隧道模式速度更快</li>
</ul>
<h3 id="隧道模式（缺省值）"><a href="#隧道模式（缺省值）" class="headerlink" title="隧道模式（缺省值）"></a>隧道模式（缺省值）</h3><ul>
<li>加密整个私有IP包，包括IP包头，更安全，相比传输模式速度更慢</li>
</ul>
<h2 id="配置IPsecVPN的命令（点到点VPN）"><a href="#配置IPsecVPN的命令（点到点VPN）" class="headerlink" title="配置IPsecVPN的命令（点到点VPN）"></a>配置IPsecVPN的命令（点到点VPN）</h2><ul>
<li>大体分为2个阶段</li>
</ul>
<h3 id="管理连接"><a href="#管理连接" class="headerlink" title="管理连接"></a>管理连接</h3><ul>
<li>通信双方设备通过<strong>非对称加密算法</strong>加密<strong>对称算法所使用的对称密钥</strong></li>
</ul>
<h4 id="进入传输级配置模式"><a href="#进入传输级配置模式" class="headerlink" title="进入传输级配置模式"></a>进入传输级配置模式</h4><ul>
<li>在全局配置模式下，进入传输级策略配置模式</li>
</ul>
<blockquote>
<p><code>&lt;num&gt;</code>：传输集，策略集。定义策略集的表号</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crypto isakmp policy &lt;num&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置加密算法（双方一致）"><a href="#配置加密算法（双方一致）" class="headerlink" title="配置加密算法（双方一致）"></a>配置加密算法（双方一致）</h4><ul>
<li>在传输级配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;encryption&gt;</code>：定义加密算法，<code>des</code>&#x2F;<code>3des</code>&#x2F;<code>aes</code>，通常使用<code>aes</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">encryption &lt;encryption&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置完整性算法（双方一致）"><a href="#配置完整性算法（双方一致）" class="headerlink" title="配置完整性算法（双方一致）"></a>配置完整性算法（双方一致）</h4><ul>
<li>在传输级配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;whole&gt;</code>：定义完整性算法，<code>md5</code>&#x2F;<code>sha</code>，通常使用<code>sha</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hash &lt;whole&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置非对称加密算法的长度（双方一致）"><a href="#配置非对称加密算法的长度（双方一致）" class="headerlink" title="配置非对称加密算法的长度（双方一致）"></a>配置非对称加密算法的长度（双方一致）</h4><ul>
<li>在传输级配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;length&gt;</code>：定义非对称加密算法的长度，<code>1</code>&#x2F;<code>2</code>&#x2F;<code>5</code>，通常使用<code>2</code>，表示1024字节</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">group &lt;length&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置使用共享密钥（双方一致）"><a href="#配置使用共享密钥（双方一致）" class="headerlink" title="配置使用共享密钥（双方一致）"></a>配置使用共享密钥（双方一致）</h4><ul>
<li>在传输级配置模式下</li>
<li>身份验证方式不使用非对称加密算法，而是使用预共享密钥，为了保证验证hash值时不被篡改</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">authentication pre-share</span><br></pre></td></tr></table></figure>

<h4 id="配置失效时间（可选）"><a href="#配置失效时间（可选）" class="headerlink" title="配置失效时间（可选）"></a>配置失效时间（可选）</h4><ul>
<li>在传输级配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;second&gt;</code>：单位秒，默认值86400秒</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lifetime &lt;second&gt;</span><br></pre></td></tr></table></figure>

<h4 id="进行协商"><a href="#进行协商" class="headerlink" title="进行协商"></a>进行协商</h4><ul>
<li>回到全局配置模式下进行配置</li>
</ul>
<blockquote>
<p><code>&lt;pwd&gt;</code>：预共享密钥，自定义一个密码，大于6位且越复杂越安全（双方一致）<br><code>&lt;ip&gt;</code>：对方公网IP地址</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crypto isakmp key &lt;pwd&gt; address &lt;ip&gt;</span><br></pre></td></tr></table></figure>

<h3 id="数据连接"><a href="#数据连接" class="headerlink" title="数据连接"></a>数据连接</h3><ul>
<li>通过<strong>对称加密算法</strong>加密实际所要传输的私网数据</li>
</ul>
<h4 id="定义VPN触发流量"><a href="#定义VPN触发流量" class="headerlink" title="定义VPN触发流量"></a>定义VPN触发流量</h4><ul>
<li>在全局配置模式下</li>
<li>配置哪些网段可以走隧道</li>
</ul>
<blockquote>
<p><code>100</code>：表名<br><code>&lt;ip_1&gt;</code>：源（内网）IP网段<br><code>&lt;mask_1&gt;</code>：源反子网掩码<br><code>&lt;ip_2&gt;</code>：目标（内网）IP网段<br><code>&lt;mask_2&gt;</code>：目标反子网掩码</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">access-list 100 permit ip &lt;ip_1&gt; &lt;mask_1&gt; &lt;ip_2&gt; &lt;mask_2&gt;</span><br></pre></td></tr></table></figure>

<h4 id="定义加密及认证方式（双方一致）"><a href="#定义加密及认证方式（双方一致）" class="headerlink" title="定义加密及认证方式（双方一致）"></a>定义加密及认证方式（双方一致）</h4><ul>
<li>在全局配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;name&gt;</code>：传输模式名，自定义名称<br><code>&lt;support&gt;</code>：支持选项</p>
<blockquote>
<p><code>esp</code>：支持加密及认证<br><code>ah</code>：只支持认证。国内用的比较少</p>
</blockquote>
</blockquote>
<blockquote>
<p><code>&lt;encryption&gt;</code>：定义加密算法，<code>des</code>&#x2F;<code>3des</code>&#x2F;<code>aes</code><br><code>&lt;whole&gt;</code>：定义完整性算法，<code>md5</code>&#x2F;<code>sha</code></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crypto ipsec transform-set &lt;name&gt; esp-&lt;encryption&gt; &lt;support&gt;-&lt;whole&gt;-hmac</span><br></pre></td></tr></table></figure>

<h3 id="应用阶段"><a href="#应用阶段" class="headerlink" title="应用阶段"></a>应用阶段</h3><h4 id="创建MAP映射表"><a href="#创建MAP映射表" class="headerlink" title="创建MAP映射表"></a>创建MAP映射表</h4><ul>
<li>在全局配置模式下，进入MAP表配置模式</li>
<li>将阶段1和阶段2进行映射，并应用到端口</li>
<li>此时IPsecVPN生效</li>
</ul>
<blockquote>
<p><code>&lt;mapname&gt;</code>：MAP表名<br><code>1</code>：MAP表标识</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crypto map &lt;mapname&gt; 1 ipsec-isakmp</span><br></pre></td></tr></table></figure>

<h4 id="匹配VPN流量"><a href="#匹配VPN流量" class="headerlink" title="匹配VPN流量"></a>匹配VPN流量</h4><ul>
<li>在MAP表配置模式下</li>
</ul>
<blockquote>
<p><code>100</code>：定义VPN触发流量的表名</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">match address 100</span><br></pre></td></tr></table></figure>

<h4 id="匹配加密及认证方式"><a href="#匹配加密及认证方式" class="headerlink" title="匹配加密及认证方式"></a>匹配加密及认证方式</h4><ul>
<li>在MAP表配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;name&gt;</code>：加密及认证方式的表名</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set transform-set &lt;name&gt;</span><br></pre></td></tr></table></figure>

<h4 id="配置对方的公网IP"><a href="#配置对方的公网IP" class="headerlink" title="配置对方的公网IP"></a>配置对方的公网IP</h4><ul>
<li>在MAP表配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;ip&gt;</code>：对方的公网IP</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set peer &lt;ip&gt;</span><br></pre></td></tr></table></figure>

<h4 id="将MAP表应用到外网端口"><a href="#将MAP表应用到外网端口" class="headerlink" title="将MAP表应用到外网端口"></a>将MAP表应用到外网端口</h4><ul>
<li>在端口配置模式下</li>
</ul>
<blockquote>
<p><code>&lt;mapname&gt;</code>：MAP表名</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crypto map &lt;mapname&gt;</span><br></pre></td></tr></table></figure>

<p><strong>一个接口只能应用一个MAP表（踩坑）</strong></p>
<ul>
<li>为了解决一个接口对接多个VPN隧道问题，设置MAP表名时都<strong>设置相同的表名</strong>，设置表标识时<strong>设置不同的表标识</strong>，通过表标识来区分不同的MAP表，从而解决一个接口对接多个VPN隧道</li>
</ul>
<h3 id="查看命令"><a href="#查看命令" class="headerlink" title="查看命令"></a>查看命令</h3><h4 id="查看阶段1的状态"><a href="#查看阶段1的状态" class="headerlink" title="查看阶段1的状态"></a>查看阶段1的状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show crypto isakmp sa</span><br></pre></td></tr></table></figure>

<h4 id="查看阶段2的状态"><a href="#查看阶段2的状态" class="headerlink" title="查看阶段2的状态"></a>查看阶段2的状态</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show crypto ipsec sa</span><br></pre></td></tr></table></figure>

<h4 id="查看阶段1的策略配置集"><a href="#查看阶段1的策略配置集" class="headerlink" title="查看阶段1的策略配置集"></a>查看阶段1的策略配置集</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show crypto isakmp policy</span><br></pre></td></tr></table></figure>

<h4 id="查看阶段2的策略配置集"><a href="#查看阶段2的策略配置集" class="headerlink" title="查看阶段2的策略配置集"></a>查看阶段2的策略配置集</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show crypto ipsec transform-set</span><br></pre></td></tr></table></figure>

<h2 id="配置SSL-VPN服务器的命令（远程访问VPN）"><a href="#配置SSL-VPN服务器的命令（远程访问VPN）" class="headerlink" title="配置SSL VPN服务器的命令（远程访问VPN）"></a>配置SSL VPN服务器的命令（远程访问VPN）</h2><ul>
<li>个人不需要配置，只需要在服务器部署一个VPN服务器即可</li>
</ul>
<p><a href="/2021/08/21/%E5%9C%A8WindowsServer2003%E9%83%A8%E7%BD%B2VPN%E6%9C%8D%E5%8A%A1%E5%99%A8/">传送门</a></p>
<h2 id="完成"><a href="#完成" class="headerlink" title="完成"></a>完成</h2><h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><p><a href="/302.html?target=https://www.bilibili.com/video/BV1Lf4y1t7Mc/">哔哩哔哩——千锋教育网络安全学院</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div><svg class="coin" width="28" height="28" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M14.045 25.5454C7.69377 25.5454 2.54504 20.3967 2.54504 14.0454C2.54504 7.69413 7.69377 2.54541 14.045 2.54541C20.3963 2.54541 25.545 7.69413 25.545 14.0454C25.545 17.0954 24.3334 20.0205 22.1768 22.1771C20.0201 24.3338 17.095 25.5454 14.045 25.5454ZM9.66202 6.81624H18.2761C18.825 6.81624 19.27 7.22183 19.27 7.72216C19.27 8.22248 18.825 8.62807 18.2761 8.62807H14.95V10.2903C17.989 10.4444 20.3766 12.9487 20.3855 15.9916V17.1995C20.3854 17.6997 19.9799 18.1052 19.4796 18.1052C18.9793 18.1052 18.5738 17.6997 18.5737 17.1995V15.9916C18.5667 13.9478 16.9882 12.2535 14.95 12.1022V20.5574C14.95 21.0577 14.5444 21.4633 14.0441 21.4633C13.5437 21.4633 13.1382 21.0577 13.1382 20.5574V12.1022C11.1 12.2535 9.52148 13.9478 9.51448 15.9916V17.1995C9.5144 17.6997 9.10883 18.1052 8.60856 18.1052C8.1083 18.1052 7.70273 17.6997 7.70265 17.1995V15.9916C7.71158 12.9487 10.0992 10.4444 13.1382 10.2903V8.62807H9.66202C9.11309 8.62807 8.66809 8.22248 8.66809 7.72216C8.66809 7.22183 9.11309 6.81624 9.66202 6.81624Z" fill="currentColor"></path></svg></div>
  <button>
    储钱罐
  </button>
  <div class="post-reward">
      <div>
        <img src="/assets/images/reward/images/wxpay.png" alt="57uv6Z6g 微信支付">
        <span>微信支付</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/alipay.png" alt="57uv6Z6g 支付宝">
        <span>支付宝</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/qqpay.png" alt="57uv6Z6g qqpay">
        <span>qqpay</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/bitcoin.png" alt="57uv6Z6g 比特币">
        <span>比特币</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/ethereum.png" alt="57uv6Z6g ethereum">
        <span>ethereum</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/monero.png" alt="57uv6Z6g monero">
        <span>monero</span>
      </div>
      <div>
        <img src="/assets/images/reward/images/paypal.png" alt="57uv6Z6g 贝宝">
        <span>贝宝</span>
      </div>

  </div>
</div>


        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/08/14/%E5%8A%A8%E6%80%81%E8%B7%AF%E7%94%B1/" rel="prev" title="【笔记】动态路由">
                  <i class="fa fa-angle-left"></i> 【笔记】动态路由
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/08/14/MacOS%E5%88%BB%E5%BD%95%E9%9F%B3%E4%B9%90%E5%85%89%E7%9B%98/" rel="next" title="【笔记】MacOS刻录音乐光盘">
                  【笔记】MacOS刻录音乐光盘 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments"><div id="twikoo-comments"></div></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 2019 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">57uv6Z6g</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>
<div id="site-time"></div>


<div id="current-visitors-count"></div>


<div id="site-badge"></div>


<div id="loading-door-left"></div>
<div id="loading-door-right"></div>
<a id="loading-door-a" href="javascript:loadingDoorOpen();">芝麻开门</a>


<div id="waifu">
  <div id="waifu-tips"></div>
  <canvas id="live2d" width="800" height="800"></canvas>
</div>
<div id="waifu-toggle">
  <span>看板娘</span>
</div>


<link rel="stylesheet" href="/dist/bundle.css">


<script src="/dist/bundle.js"></script>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>
<script class="next-config" data-name="twikoo" type="application/json">{"enable":true,"visitor":false,"envId":"https://twikoo.loli.fj.cn","jsUrl":"https://unpkg.com/twikoo@1.6.44/dist/twikoo.min.js","el":"#twikoo-comments"}</script>
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.twikoo.el)
    .then(() => NexT.utils.getScript(
      CONFIG.twikoo.jsUrl || 'https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js',
      { condition: window.twikoo }
    ))
    .then(() => {
      twikoo.init(CONFIG.twikoo);
    });
});
</script>
<style>
.post-block, .comments {
  overflow: visible;
}
.tk-owo-emotion {
  display: inline-block;
}
</style>

</body>
</html>
